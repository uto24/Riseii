<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gas Fee Payment - Riseii</title>
    <!-- Dependencies -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@400;600;700;800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Anek+Bangla:wght@400;500;600&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        :root {
            --primary-bg: #f7f9fc;
            --secondary-bg: #ffffff;
            --text-dark: #1e293b;
            --text-light: #475569;
            --accent-color: #4f46e5;
            --success-color: #10b981;
            --warning-color: #f59e0b;
            --danger-color: #ef4444;
            --border-color: #e2e8f0;
        }
        body { font-family: 'Nunito Sans', sans-serif; background-color: var(--primary-bg); color: var(--text-dark); margin: 0; }
        .bengali-text { font-family: 'Anek Bangla', sans-serif; }
        .main-header { background-color: var(--secondary-bg); padding: 15px 20px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); display: flex; justify-content: space-between; align-items: center; }
        .header-left a, .header-right a { font-weight: 800; color: var(--accent-color); text-decoration: none; font-size: 1.5rem; }
        .main-content { max-width: 800px; margin: 40px auto; padding: 0 20px; }
        
        .content-card { background-color: var(--secondary-bg); border-radius: 12px; padding: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.08); margin-bottom: 30px; }
        .content-card h2 { font-size: 1.8rem; margin-bottom: 15px; display: flex; align-items: center; gap: 10px; color: var(--accent-color); }
        .content-card p, .content-card li { color: var(--text-light); line-height: 1.8; }
        .content-card ul { padding-left: 20px; list-style: none; }
        .content-card ul li { padding-left: 1.5em; position: relative; margin-bottom: 10px; }
        .content-card ul li::before {
            content: '\f058'; /* Font Awesome check-circle icon */
            font-family: 'Font Awesome 6 Free';
            font-weight: 900;
            color: var(--success-color);
            position: absolute;
            left: 0;
            top: 5px;
        }

        .payment-section h2 { text-align: center; }
        .payment-number { background-color: var(--primary-bg); padding: 15px; border-radius: 8px; text-align: center; margin-bottom: 20px; display: flex; justify-content: space-between; align-items: center; }
        .payment-number span { font-size: 1.5rem; font-weight: 700; letter-spacing: 2px; }
        .copy-btn { background: none; border: 1px solid var(--border-color); color: var(--accent-color); cursor: pointer; padding: 8px 12px; border-radius: 6px; font-weight: 600; }
        
        .input-group { margin-bottom: 1.2rem; }
        .input-group label { display: block; font-weight: 600; margin-bottom: 8px; }
        .input-group input, .input-group select { width: 100%; padding: 14px; border: 1px solid var(--border-color); border-radius: 8px; font-size: 1rem; }
        
        .btn { width: 100%; padding: 15px; background-color: var(--accent-color); color: #fff; border: none; border-radius: 8px; cursor: pointer; font-size: 1.1rem; font-weight: 600; }
        .btn:disabled { background-color: #9ca3af; cursor: not-allowed; }
        .status-message { text-align: center; margin-top: 15px; font-weight: 600; }
    </style>
</head>
<body>

    <header class="main-header">
        <div class="header-left"><a href="/">Riseii</a></div>
        <div class="header-right"><a href="/dashboard">My Profile</a></div>
    </header>

    <main class="main-content">
        <!-- Gas Fee Info Section -->
        
              <div class="content-card">
    <h2><i class="fa-solid fa-key"></i> Passkey ржирж┐рждрзЗ ржмрж┐рж╕рзНрждрж╛рж░рж┐ржд ржжрзЗржЦрзБржи!</h2>
    <p class="bengali-text" style="text-align: center; font-weight: 600; font-size: 1.2rem;">
        ржкрж╛рж╕ржХрзА ржкрзЗрждрзЗ рж╣рж▓рзЗ ржПржХржХрж╛рж▓рзАржи ржЧрзНржпрж╛рж╕ ржлрж┐ ржжрж┐рждрзЗ рж╣ржмрзЗред <br> ржирж┐ржЪрзЗ ржмрж┐рж╕рзНрждрж╛рж░рж┐ржд ржкрзЬрзБржи!
    </p>

    <hr style="border: none; border-top: 1px dashed #ddd; margin: 25px 0;">

    <div>
        <h4 style="font-size: 1.3rem; color: #1e293b; margin-bottom: 10px;">ЁЯФС Passkey ржХрзА?</h4>
        <p class="bengali-text">
            Passkey рж╣рж▓рзЛ ржЖржкржирж╛рж░ ржЕрзНржпрж╛ржХрж╛ржЙржирзНржЯрзЗрж░ ржПржХржЯрж┐ ржЗржЙржирж┐ржХ ржПржмржВ ржЧрзЛржкржи **ржорж╛рж╕рзНржЯрж╛рж░ ржХрзЛржб**ред ржПржЯрж┐ ржЖржкржирж╛рж░ рж╕рж╛ржзрж╛рж░ржг ржкрж╛рж╕ржУрзЯрж╛рж░рзНржбрзЗрж░ ржЪрзЗрзЯрзЗржУ ржЕржирзЗржХ ржмрзЗрж╢рж┐ рж╢ржХрзНрждрж┐рж╢рж╛рж▓рзА ржПржмржВ рж╢рзБржзрзБржорж╛рждрзНрж░ ржЖржкржирж┐ржЗ ржПржЯрж┐ ржЬрж╛ржиржмрзЗржиред
        </p>
    </div>

    <div style="margin-top: 25px;">
        <h4 style="font-size: 1.3rem; color: #1e293b; margin-bottom: 10px;">ЁЯЫбя╕П ржХрзЗржи ржПржЯрж┐ ржЖржкржирж╛рж░ ржЬржирзНржп ржЕржкрж░рж┐рж╣рж╛рж░рзНржп?</h4>
        <p class="bengali-text">
            ржЖржкржирж╛рж░ ржХрж╖рзНржЯрж╛рж░рзНржЬрж┐ржд ржЯрж╛ржХрж╛ ржПржмржВ ржЕрзНржпрж╛ржХрж╛ржЙржирзНржЯрзЗрж░ рж╕ржорзНржкрзВрж░рзНржг рж╕рзБрж░ржХрзНрж╖рж╛рж░ ржЬржирзНржп ржкрзНрж░рждрж┐ржЯрж┐ ржЙржЗржержбрзНрж░рзЯрж╛рж▓рзЗрж░ рж╕ржорзЯ ржПржЗ Passkey ржкрзНрж░рзЯрзЛржЬржи рж╣ржмрзЗред ржПрж░ ржлрж▓рзЗ, ржХрзЗржЙ ржЖржкржирж╛рж░ ржЕрзНржпрж╛ржХрж╛ржЙржирзНржЯрзЗрж░ ржкрж╛рж╕ржУрзЯрж╛рж░рзНржб ржЬрзЗржирзЗ ржЧрзЗрж▓рзЗржУ ржЖржкржирж╛рж░ ржЯрж╛ржХрж╛ рж╕ржорзНржкрзВрж░рзНржг ржирж┐рж░рж╛ржкржж ржерж╛ржХржмрзЗред
        </p>
    </div>

    <div style="margin-top: 25px;">
        <h4 style="font-size: 1.3rem; color: #1e293b; margin-bottom: 10px;">ЁЯУз ржХрзАржнрж╛ржмрзЗ Passkey ржкрж╛ржмрзЗржи?</h4>
        <p class="bengali-text">
            ржЖржкржирж┐ ржпржЦржи рж╕ржлрж▓ржнрж╛ржмрзЗ **ржПржХржмрж╛рж░ ржЧрзНржпрж╛рж╕ ржлрж┐ ржкрзЗржорзЗржирзНржЯ** ржХрж░ржмрзЗржи, рждржЦржи ржЖржорж╛ржжрзЗрж░ рж╕рж┐рж╕рзНржЯрзЗржо ржЖржкржирж╛рж░ ржЬржирзНржп ржПржХржЯрж┐ ржЗржЙржирж┐ржХ Passkey рждрзИрж░рж┐ ржХрж░ржмрзЗ ржПржмржВ рж╕рзЗржЯрж┐ ржЖржкржирж╛рж░ **рж░рзЗржЬрж┐рж╕рзНржЯрж╛рж░рзНржб ржЗржорзЗржЗрж▓ ржарж┐ржХрж╛ржирж╛рзЯ** ржкрж╛ржарж┐рзЯрзЗ ржжрзЗржУрзЯрж╛ рж╣ржмрзЗред ржПржЗ Passkey-ржЯрж┐ ╨▒╨╡╤А╨╡╨╢╨╜╨╛ (carefully) рж╕ржВрж░ржХрзНрж╖ржг ржХрж░рзБржи, ржХрж╛рж░ржг ржПржЯрж┐ ржЖржкржирж╛рж░ ржЕрзНржпрж╛ржХрж╛ржЙржирзНржЯрзЗрж░ ржПржХржЯрж┐ ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг ржЕржВрж╢ред
        </p>
    </div>
</div>

        <div class="content-card">
            <h2><i class="fas fa-shield-alt"></i> ржЧрзНржпрж╛рж╕ ржлрж┐ ржХрзА ржПржмржВ ржХрзЗржи ржкрзНрж░ржпрж╝рзЛржЬржи?</h2>
            <p class="bengali-text">
                ржЧрзНржпрж╛рж╕ ржлрж┐ ржХрзЛржирзЛ рж░рзЗржЬрж┐рж╕рзНржЯрзНрж░рзЗрж╢ржи ржлрж┐ ржиржпрж╝, ржмрж░ржВ ржПржЯрж┐ ржЖржкржирж╛рж░ ржЕрзНржпрж╛ржХрж╛ржЙржирзНржЯрзЗрж░ ржЬржирзНржп ржПржХржЯрж┐ <strong>ржПржХржХрж╛рж▓рзАржи ржирж┐рж░рж╛ржкрждрзНрждрж╛ ржУ ржЕрзНржпрж╛ржХрзНржЯрж┐ржнрзЗрж╢ржи ржЪрж╛рж░рзНржЬ</strong>ред ржПржЗ ржЫрзЛржЯрзНржЯ ржПржХржЯрж┐ ржкрзЗржорзЗржирзНржЯ ржирж┐рж╢рзНржЪрж┐ржд ржХрж░рзЗ ржпрзЗ ржЖржкржирж┐ ржЖржорж╛ржжрзЗрж░ ржкрзНрж▓рзНржпрж╛ржЯржлрж░рзНржорзЗрж░ ржПржХржЬржи ьзДьзАэХЬ (serious) рж╕ржжрж╕рзНржп ржПржмржВ ржЖржкржирж╛рж░ ржЕрзНржпрж╛ржХрж╛ржЙржирзНржЯржЯрж┐ рж╕рж░рзНржмрзЛржЪрзНржЪ рж╕рзНрждрж░рзЗрж░ рж╕рзБрж░ржХрзНрж╖рж╛ ржкрж╛ржмрзЗред
            </p>
        </div>

        <!-- Why Pay Gas Fee Section -->
        <div class="content-card">
            <h2><i class="fas fa-gem"></i> ржЧрзНржпрж╛рж╕ ржлрж┐ ржжрзЗржУрзЯрж╛рж░ ржмрж┐рж╢рзЗрж╖ рж╕рзБржмрж┐ржзрж╛</h2>
            <p class="bengali-text">
                ржПржЗ ржЯрж╛ржХрж╛ ржжрзЗржУрзЯрж╛рж░ ржорж╛ржзрзНржпржорзЗ ржЖржкржирж╛рж░ ржЙржжрж╛рж░ ржорж╛ржирж╕рж┐ржХрждрж╛рж░ ржПржмржВ ржХрж╛ржЬрзЗрж░ ржкрзНрж░рждрж┐ ржЖржЧрзНрж░рж╣рзЗрж░ ржПржХржЯрж┐ ржкрж░рзАржХрзНрж╖рж╛ ржирзЗржУрзЯрж╛ рж╣ржмрзЗ, ржпрж╛ ржЖржкржирж╛ржХрзЗ ржЖржорж╛ржжрзЗрж░ ржмрж┐рж╢рзЗрж╖ рж╕ржжрж╕рзНржп рж╣рж┐рж╕рзЗржмрзЗ ржкрж░рж┐ржЪрж┐рждрж┐ ржжрзЗржмрзЗред
            </p>
            <ul>
                <li>
                    <strong><i class="fas fa-user-shield"></i> рж╣рзНржпрж╛ржХрж┐ржВ ржерзЗржХрзЗ рж╕рж░рзНржмрзЛржЪрзНржЪ рж╕рзБрж░ржХрзНрж╖рж╛:</strong> ржЧрзНржпрж╛рж╕ ржлрж┐ ржжрзЗржУрзЯрж╛ ржорж╛ржирзЗ ржЖржорж╛ржжрзЗрж░ <strong>VIP рж▓рж┐рж╕рзНржЯрзЗ</strong> ржЪрж▓рзЗ ржЖрж╕рж╛ред VIP ржЕрзНржпрж╛ржХрж╛ржЙржирзНржЯржЧрзБрж▓рзЛрждрзЗ ржЖржорж░рж╛ Passkey ржЫрж╛рзЬрж╛ рж▓ржЧржЗржи ржХрж░рж╛рж░ ржЕржирзБржорждрж┐ ржжрж┐ржЗ ржирж╛, ржпрж╛ ржЖржкржирж╛рж░ ржЕрзНржпрж╛ржХрж╛ржЙржирзНржЯржХрзЗ рж╣рзНржпрж╛ржХрж╛рж░ (ржПржоржиржХрж┐ ржЖржкржирж╛рж░ рж░рзЗржлрж╛рж░рж╛рж░) ржерзЗржХрзЗ рж╕ржорзНржкрзВрж░рзНржг рж╕рзБрж░ржХрзНрж╖рж┐ржд рж░рж╛ржЦрзЗред
                </li>
                <li>
                    <strong><i class="fas fa-star"></i> ржкрзНрж░рж┐ржорж┐рзЯрж╛ржо ржЯрж╛рж╕рзНржХ ржЖржирж▓ржХ:</strong> рж╢рзБржзрзБржорж╛рждрзНрж░ ржЧрзНржпрж╛рж╕ ржлрж┐ ржжрзЗржУрзЯрж╛ ржмрзНржпржмрж╣рж╛рж░ржХрж╛рж░рзАрж░рж╛ржЗ ржЖржорж╛ржжрзЗрж░ рж╕ржмржЪрзЗрзЯрзЗ ржмрзЗрж╢рж┐ ржкрзЗржорзЗржирзНржЯрзЗрж░ ржПржмржВ рж╕рзНржкрзЗрж╢рж╛рж▓ ржЯрж╛рж╕рзНржХржЧрзБрж▓рзЛ ржХрж░рж╛рж░ рж╕рзБржпрзЛржЧ ржкрж╛ржиред
                </li>
                <li>
                    <strong><i class="fas fa-bolt"></i> ржжрзНрж░рзБржд рж╕рж╛ржкрзЛрж░рзНржЯ ржУ ржкрзЗржорзЗржирзНржЯ:</strong> VIP рж╕ржжрж╕рзНржпрж░рж╛ ржпрзЗржХрзЛржирзЛ рж╕ржорж╕рзНржпрж╛рзЯ ржЕржЧрзНрж░рж╛ржзрж┐ржХрж╛рж░ржорзВрж▓ржХ рж╕рж╛ржкрзЛрж░рзНржЯ ржПржмржВ ржжрзНрж░рзБржд ржЙржЗржержбрзНрж░рзЯрж╛рж▓ ржкрзНрж░рж╕рзЗрж╕рж┐ржВ-ржПрж░ рж╕рзБржмрж┐ржзрж╛ ржкрж╛ржиред
                </li>
                <li>
                    <strong><i class="fas fa-lock-open"></i> рж╕ржорзНржкрзВрж░рзНржг ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕:</strong> ржЧрзНржпрж╛рж╕ ржлрж┐ ржЫрж╛рзЬрж╛ ржЖржкржирж┐ ржЖржорж╛ржжрзЗрж░ ржкрзНрж▓рзНржпрж╛ржЯржлрж░рзНржорзЗ ржХрж╛ржЬ ржХрж░рзЗ ржЙржкрж╛рж░рзНржЬржи рж╢рзБрж░рзБ ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗржи ржирж╛ред ржПржЯрж┐ржЗ ржЖржкржирж╛рж░ ржЙржкрж╛рж░рзНржЬржирзЗрж░ ржЬржЧрждрзЗрж░ ржЪрж╛ржмрж┐ржХрж╛ржарж┐ред
                </li>
            </ul>
        </div>

        <!-- Payment Section -->
        <div class="content-card payment-section">
            <h2><i class="fas fa-money-check-dollar"></i> ржЧрзНржпрж╛рж╕ ржлрж┐ ржкрзЗржорзЗржирзНржЯ ржХрж░рзБржи (ржПржХржХрж╛рж▓рзАржи: рзирзжрз│)</h2>
            <p class="bengali-text">ржирж┐ржЪрзЗрж░ ржиржорзНржмрж░рзЗ <strong>рзирзж ржЯрж╛ржХрж╛</strong> рж╕рзЗржирзНржб ржорж╛ржирж┐ ржХрж░рзБржи ржПржмржВ рждрж╛рж░ржкрж░ ржЖржкржирж╛рж░ ржкрзЗржорзЗржирзНржЯрзЗрж░ рждржерзНржп ржЬржорж╛ ржжрж┐ржиред</p>
            
            <div class="input-group">
                <label for="method">Select Method</label>
                <select id="method" required>
                    <option value="bkash">bKash</option>
                    <option value="nagad">Nagad</option>
                </select>
            </div>
            
            <div class="payment-number">
                <span id="payment-number-display">01912107604 (bKash)</span>
                <button class="copy-btn" id="copy-btn">Copy</button>
            </div>

            <form id="gas-fee-form">
                <div class="input-group">
                    <label for="senderNumber">ржЖржкржирж╛рж░ рж╕рзЗржирзНржбрж╛рж░ ржиржорзНржмрж░</label>
                    <input type="text" id="senderNumber" placeholder="ржпрзЗ ржиржорзНржмрж░ ржерзЗржХрзЗ ржЯрж╛ржХрж╛ ржкрж╛ржарж┐рзЯрзЗржЫрзЗржи" required>
                </div>
                <div class="input-group">
                    <label for="trxId">ржЯрзНрж░рж╛ржиржЬрзЗржХрж╢ржи ржЖржЗржбрж┐ (TrxID)</label>
                    <input type="text" id="trxId" placeholder="ржЖржкржирж╛рж░ ржкрзЗржорзЗржирзНржЯрзЗрж░ TrxID" required>
                </div>
                <button type="submit" class="btn" id="submit-btn">Submit Payment Info</button>
                <p id="status-message" class="status-message"></p>
            </form>
        </div>
    </main>


<!-- START: Telegram Contact Widget -->
<style>
    .telegram-widget {
        position: fixed;
        bottom: 25px;
        right: 25px;
        z-index: 1000;
    }
    .telegram-widget .tg-button {
        display: flex;
        align-items: center;
        justify-content: center;
        width: 60px;
        height: 60px;
        background-color: #0088cc; /* Telegram Blue */
        border-radius: 50%;
        color: white;
        font-size: 30px;
        text-decoration: none;
        box-shadow: 0 4px 15px rgba(0, 136, 204, 0.4);
        transition: all 0.3s ease;
        position: relative;
    }
    .telegram-widget .tg-button:hover {
        transform: scale(1.1) rotate(15deg);
        box-shadow: 0 8px 25px rgba(0, 136, 204, 0.5);
    }
    .telegram-widget .tg-tooltip {
        position: absolute;
        right: 75px; /* Position to the left of the button */
        top: 50%;
        transform: translateY(-50%);
        background-color: #2c2f33;
        color: white;
        padding: 8px 15px;
        border-radius: 6px;
        white-space: nowrap;
        font-size: 14px;
        font-weight: 600;
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.3s ease, visibility 0.3s ease;
        pointer-events: none; /* So it doesn't interfere with the button hover */
    }
    .telegram-widget .tg-button:hover + .tg-tooltip {
        opacity: 1;
        visibility: visible;
    }
    /* Simple animation for the button */
    @keyframes pulse {
        0% { transform: scale(0.95); }
        70% { transform: scale(1.05); }
        100% { transform: scale(0.95); }
    }
    .telegram-widget .tg-button {
        animation: pulse 2s infinite;
    }
</style>

<div class="telegram-widget">
    <a href="http://t.me/riseii_bot" class="tg-button" target="_blank" aria-label="Contact us on Telegram">
        <i class="fab fa-telegram-plane"></i>
    </a>
    <span class="tg-tooltip">Contact Us!</span>
</div>
<!-- END: Telegram Contact Widget -->

<!-- IMPORTANT: Add Font Awesome for the icon to work -->
<!-- Paste this line in the <head> section of your HTML file -->
<!-- <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css"> -->



<section style="background: #b900ff; padding: 15px; text-align: center;">
    <h3>┬й 2025 Riseii. v2</h3>
</section>

<script>
    const SUPABASE_URL = 'https://gsfgrycmlngptzirwicl.supabase.co';
    const SUPABASE_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImdzZmdyeWNtbG5ncHR6aXJ3aWNsIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTA1NjgwNTksImV4cCI6MjA2NjE0NDA1OX0.uWGXs8dd1TNpdGpd6P8oyr2udzXPIrghcp667zOKdv4';
    const supabaseClient = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

    let currentUser = null;
    let userProfile = null;
    const paymentNumbers = {
        bkash: '01912107604',
        nagad: '01912107604'
    };

    async function initializePage() {
        const { data: { session } } = await supabaseClient.auth.getSession();
        if (!session) { window.location.href = 'login.html'; return; }
        currentUser = session.user;
        
        const { data: profile } = await supabaseClient.from('profiles').select('*').eq('id', currentUser.id).single();
        userProfile = profile;
    }

    document.getElementById('method').addEventListener('change', (e) => {
        const selectedMethod = e.target.value;
        document.getElementById('payment-number-display').textContent = `${paymentNumbers[selectedMethod]} (${selectedMethod})`;
    });

    document.getElementById('copy-btn').addEventListener('click', () => {
        const selectedMethod = document.getElementById('method').value;
        const numberToCopy = paymentNumbers[selectedMethod];
        navigator.clipboard.writeText(numberToCopy).then(() => {
            alert(`Number ${numberToCopy} copied to clipboard!`);
        });
    });

    document.getElementById('gas-fee-form').addEventListener('submit', async (e) => {
        e.preventDefault();
        
        const submitBtn = document.getElementById('submit-btn');
        const statusMsg = document.getElementById('status-message');
        const method = document.getElementById('method').value;
        const senderNumber = document.getElementById('senderNumber').value.trim();
        const trxId = document.getElementById('trxId').value.trim().toUpperCase();

        if (!senderNumber || !trxId) {
            alert('Please fill in all fields.'); return;
        }

        submitBtn.disabled = true;
        submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Submitting...';
        
        const { data: existing } = await supabaseClient
            .from('gas_fees')
            .select('id')
            .eq('trx_id', trxId)
            .single();
        
        if (existing) {
            alert('This Transaction ID has already been used. Please check and try again.');
            submitBtn.disabled = false;
            submitBtn.innerText = 'Submit Payment Info';
            return;
        }

        let attempts = 0;
        const maxAttempts = Math.floor(Math.random() * 3) + 5;

        const trySubmit = setInterval(async () => {
            attempts++;
            statusMsg.textContent = `Verifying payment... Attempt ${attempts}/${maxAttempts}`;
            
            if (attempts >= maxAttempts) {
                clearInterval(trySubmit);
                statusMsg.textContent = 'Verification successful!';
                statusMsg.style.color = 'var(--success-color)';

                const { error: insertError } = await supabaseClient
                    .from('gas_fees')
                    .insert({
                        user_id: currentUser.id,
                        user_name: userProfile.full_name,
                        user_email: userProfile.email,
                        payment_method: method,
                        sender_number: senderNumber,
                        trx_id: trxId
                    });

                if (insertError) {
                    statusMsg.textContent = 'Error saving data. Please try again.';
                    statusMsg.style.color = 'var(--danger-color)';
                } else {
                    alert('Your Gas Fee payment information has been submitted successfully! It will be verified by an admin soon.');
                    window.location.href = 'profile.html';
                }

                submitBtn.disabled = false;
                submitBtn.innerText = 'Submit Payment Info';
            }
        }, 800);
    });

    document.addEventListener('DOMContentLoaded', initializePage);
</script>
</body>
</html>
